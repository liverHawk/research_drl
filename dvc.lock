schema: '2.0'
stages:
  prepare_cleaning:
    cmd: uv run src/1_prepare/cleaning.py data/raw/CICIDS2017_improved
    deps:
    - path: data/raw/CICIDS2017_improved
      hash: md5
      md5: 97448ae36a9acd7110a7c6dafed93e84.dir
      size: 1152270765
      nfiles: 5
    - path: src/1_prepare/cleaning.py
      hash: md5
      md5: 1fa736b26cd25366860c28e1c31b015b
      size: 5053
    params:
      params.yaml:
        prepare.adjustment.attempted: false
        prepare.adjustment.combine_web_attack: true
        prepare.adjustment.tool_separate: false
    outs:
    - path: data/processed/cleaned
      hash: md5
      md5: a15df589b372a5205781803668ccfdf8.dir
      size: 191314377
      nfiles: 5
    - path: labels.txt
      hash: md5
      md5: 125709ed79f960d7f27693f0639b755b
      size: 91
    - path: logs/cleaning.log
      hash: md5
      md5: a248f649caff2679c9aff57aab04394f
      size: 136
  prepare_normalize:
    cmd: uv run src/1_prepare/normalize.py data/processed/cleaned
    deps:
    - path: data/processed/cleaned
      hash: md5
      md5: a15df589b372a5205781803668ccfdf8.dir
      size: 191314377
      nfiles: 5
    - path: src/1_prepare/normalize.py
      hash: md5
      md5: 92455a1aa71d6d5d9237db35f29ea512
      size: 3536
    params:
      params.yaml:
        prepare.normalize_method: MinMaxScaler
        prepare.test_size: 0.3
    outs:
    - path: data/processed/normalized
      hash: md5
      md5: 3c25d903ffd30f0307b3db5e520bbdc5.dir
      size: 77454769
      nfiles: 5
    - path: logs/normalize.log
      hash: md5
      md5: 81631ff53ff0d81a663a9a57c71d8bb0
      size: 5755
  prepare_sampling:
    cmd: uv run src/1_prepare/sampling.py data/processed/normalized/train
    deps:
    - path: data/processed/normalized/train
      hash: md5
      md5: 12700971c713ee7c9e28382d99b4d6f3.dir
      size: 54239393
      nfiles: 3
    - path: src/1_prepare/sampling.py
      hash: md5
      md5: d9d678891598e38a63e5b809b313e018
      size: 3673
    params:
      params.yaml:
        prepare.oversampling.method: None
        prepare.oversampling.params:
          neighbors: 3
          seed: 42
          sampling_strategy: auto
    outs:
    - path: data/processed/sampled
      hash: md5
      md5: 55a9411ee68e4b8c42aeaa855ad1f298.dir
      size: 54239366
      nfiles: 3
    - path: logs/sampling.log
      hash: md5
      md5: 83d1c179c27161f5224ea3788627c82c
      size: 143
  train:
    cmd: uv run src/2_train/multi_train.py data/processed/sampled
    deps:
    - path: data/processed/sampled
      hash: md5
      md5: 55a9411ee68e4b8c42aeaa855ad1f298.dir
      size: 54239366
      nfiles: 3
    - path: src/2_train/multi_train.py
      hash: md5
      md5: e35951b27dff0596a890f9392f54f753
      size: 15647
    params:
      params.yaml:
        train.batch_size: 256
        train.eps_decay: 10000
        train.eps_end: 0.05
        train.eps_start: 0.9
        train.gamma: 0.99
        train.lr: 0.001
        train.memory_size: 100000
        train.n_episodes: 1000
        train.port_dim: 32
        train.protocol_dim: 8
        train.sample_size: 100000
        train.tau: 0.005
        train.update_target_steps: 200
    outs:
    - path: logs/train.log
      hash: md5
      md5: 19e83256444f348ffb3648d1f4cf919b
      size: 145
    - path: logs/train_result.log
      hash: md5
      md5: 2d67ef9a1fc7670ccfc7a64881b96a38
      size: 1129594
    - path: models
      hash: md5
      md5: 68185cc814c05098df21b45816cb2f9c.dir
      size: 2457341
      nfiles: 1
    - path: train/plots
      hash: md5
      md5: 78bd5c72d7740cd36a4634bb99c92417.dir
      size: 6104903
      nfiles: 300
  evaluate:
    cmd: uv run src/3_evaluate/evaluate.py data/processed/normalized/test
    deps:
    - path: data/processed/normalized/test
      hash: md5
      md5: d8a0ecba66add3d1e1a8a0ecb4008854.dir
      size: 23215376
      nfiles: 2
    - path: models
      hash: md5
      md5: 68185cc814c05098df21b45816cb2f9c.dir
      size: 2457341
      nfiles: 1
    - path: src/3_evaluate/evaluate.py
      hash: md5
      md5: 15b40204f63159c6b825ae818cd79fd7
      size: 9957
    outs:
    - path: evaluate
      hash: md5
      md5: d0a3b122b39e8cbe117ff20c7ab6f9b6.dir
      size: 32276
      nfiles: 2
    - path: logs/evaluate.log
      hash: md5
      md5: b342351bbac093bb72386c41b1a63e1d
      size: 242
