schema: '2.0'
stages:
  prepare_cleaning:
    cmd: uv run src/1_prepare/cleaning.py data/raw/CICIDS2017_improved
    deps:
    - path: data/raw/CICIDS2017_improved
      hash: md5
      md5: 97448ae36a9acd7110a7c6dafed93e84.dir
      size: 1152270765
      nfiles: 5
    - path: src/1_prepare/cleaning.py
      hash: md5
      md5: fe013dfbfb888af361bbd07a731fc73f
      size: 4950
    params:
      params.yaml:
        prepare.adjustment.attempted: false
        prepare.adjustment.combine_web_attack: true
        prepare.adjustment.tool_separate: false
    outs:
    - path: data/processed/cleaned
      hash: md5
      md5: 76991bae4070479651abe6a6ba4c381e.dir
      size: 191314612
      nfiles: 5
    - path: labels.txt
      hash: md5
      md5: 63207b22831c738378d27e0c1363edb3
      size: 115
    - path: logs/cleaning.log
      hash: md5
      md5: e46841d8032dc60af33820ed6eb58823
      size: 136
  prepare_normalize:
    cmd: uv run src/1_prepare/normalize.py data/processed/cleaned
    deps:
    - path: data/processed/cleaned
      hash: md5
      md5: 76991bae4070479651abe6a6ba4c381e.dir
      size: 191314612
      nfiles: 5
    - path: src/1_prepare/normalize.py
      hash: md5
      md5: 92455a1aa71d6d5d9237db35f29ea512
      size: 3536
    params:
      params.yaml:
        prepare.normalize_method: MinMaxScaler
        prepare.test_size: 0.3
    outs:
    - path: data/processed/normalized
      hash: md5
      md5: 001666c2a45635f27b29858796bdc950.dir
      size: 77454741
      nfiles: 5
    - path: logs/normalize.log
      hash: md5
      md5: 306b56835521108e618a5e7f125391cc
      size: 5755
  prepare_sampling:
    cmd: uv run src/1_prepare/sampling.py data/processed/normalized/train
    deps:
    - path: data/processed/normalized/train
      hash: md5
      md5: 0f937d5b05e58939a491db20d6305cd6.dir
      size: 54238821
      nfiles: 3
    - path: src/1_prepare/sampling.py
      hash: md5
      md5: d9d678891598e38a63e5b809b313e018
      size: 3673
    params:
      params.yaml:
        prepare.oversampling.method: None
        prepare.oversampling.params:
          neighbors: 3
          seed: 42
          sampling_strategy: auto
    outs:
    - path: data/processed/sampled
      hash: md5
      md5: 7e46ac437a978d0db3039d7575939f20.dir
      size: 54238794
      nfiles: 3
    - path: logs/sampling.log
      hash: md5
      md5: 3185be47fa0851519ad9de2340d1f7c5
      size: 143
  train:
    cmd: uv run src/2_train/multi_train.py data/processed/sampled
    deps:
    - path: data/processed/sampled
      hash: md5
      md5: 7e46ac437a978d0db3039d7575939f20.dir
      size: 54238794
      nfiles: 3
    - path: src/2_train/multi_train.py
      hash: md5
      md5: 9c7f429bb8975f9dda4dae9d57629213
      size: 15645
    params:
      params.yaml:
        train.batch_size: 256
        train.eps_decay: 10000
        train.eps_end: 0.05
        train.eps_start: 0.9
        train.gamma: 0.99
        train.lr: 0.001
        train.memory_size: 100000
        train.n_episodes: 5000
        train.port_dim: 32
        train.protocol_dim: 8
        train.sample_size: 100000
        train.tau: 0.005
        train.update_target_steps: 200
    outs:
    - path: logs/train.log
      hash: md5
      md5: 04174d91b9bd970218e3dcc5c94cc6fe
      size: 145
    - path: logs/train_result.log
      hash: md5
      md5: 4841814cb4bba5d7cddd8303d7bf9ab8
      size: 6845035
    - path: models
      hash: md5
      md5: e15cc7fd6c4eaaea3afe17b6f66d3b13.dir
      size: 2458365
      nfiles: 1
    - path: train/plots
      hash: md5
      md5: e86997a7af6b404adf45645070ad8989.dir
      size: 33056750
      nfiles: 1500
  evaluate:
    cmd: uv run src/3_evaluate/evaluate.py data/processed/normalized/test
    deps:
    - path: data/processed/normalized/test
      hash: md5
      md5: 72afa08d4498437198ee3803e3a78b5b.dir
      size: 23215920
      nfiles: 2
    - path: models
      hash: md5
      md5: d935455150d0d85d3fa1f0c8269a575b.dir
      size: 2458365
      nfiles: 1
    - path: src/3_evaluate/evaluate.py
      hash: md5
      md5: 8ad6303cd66e5adf0cfb4092f64455a2
      size: 5247
    outs:
    - path: evaluate
      hash: md5
      md5: c101afabd28ba114e0d69e0245c5630a.dir
      size: 31637
      nfiles: 2
    - path: logs/evaluate.log
      hash: md5
      md5: 86aadc4b735fab3b9359484e4df3965b
      size: 242
