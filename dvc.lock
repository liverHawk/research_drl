schema: '2.0'
stages:
  prepare_cleaning:
    cmd: uv run src/1_prepare/cleaning.py data/raw/CICIDS2017_improved
    deps:
    - path: data/raw/CICIDS2017_improved
      hash: md5
      md5: 97448ae36a9acd7110a7c6dafed93e84.dir
      size: 1152270765
      nfiles: 5
    - path: src/1_prepare/cleaning.py
      hash: md5
      md5: 184838b1039cf69d0ea4d5cfb60d18c6
      size: 4416
    params:
      params.yaml:
        prepare.adjustment.attempted: false
        prepare.adjustment.combine_web_attack: true
        prepare.adjustment.tool_separate: false
    outs:
    - path: data/processed/cleaned
      hash: md5
      md5: 523d87e7f60cec7b53c205afff08df62.dir
      size: 191313684
      nfiles: 5
    - path: labels.txt
      hash: md5
      md5: 63207b22831c738378d27e0c1363edb3
      size: 115
    - path: logs/cleaning.log
      hash: md5
      md5: a6a796dc5cf587b9a8c09a20aeab57ba
      size: 136
  prepare_normalize:
    cmd: uv run src/1_prepare/normalize.py data/processed/cleaned
    deps:
    - path: data/processed/cleaned
      hash: md5
      md5: 523d87e7f60cec7b53c205afff08df62.dir
      size: 191313684
      nfiles: 5
    - path: src/1_prepare/normalize.py
      hash: md5
      md5: 3442fa6efd9ae6aa511f111d9d0af3c0
      size: 3074
    params:
      params.yaml:
        prepare.normalize_method: MinMaxScaler
        prepare.test_size: 0.3
    outs:
    - path: data/processed/normalized
      hash: md5
      md5: 94b050acd8f652d2f6ec36540a6da17c.dir
      size: 77457720
      nfiles: 5
    - path: logs/normalize.log
      hash: md5
      md5: 7db4a243d72d62dcbac6b165341e35f6
      size: 5755
  prepare_sampling:
    cmd: uv run src/1_prepare/sampling.py data/processed/normalized/train
    deps:
    - path: data/processed/normalized/train
      hash: md5
      md5: 6c1669cf0bd2226bda44e2a0b1d85ac9.dir
      size: 54219548
      nfiles: 3
    - path: src/1_prepare/sampling.py
      hash: md5
      md5: 00d5f8d1cee455f1bbe11bdea6acff70
      size: 3075
    params:
      params.yaml:
        prepare.oversampling.method: None
        prepare.oversampling.params:
          neighbors: 3
          seed: 42
          sampling_strategy: auto
    outs:
    - path: data/processed/sampled
      hash: md5
      md5: bd0625130715d04e512025e80e05e0c2.dir
      size: 54219621
      nfiles: 3
    - path: logs/sampling.log
      hash: md5
      md5: b720c92b3ce12a4481437402de43ede6
      size: 143
  train:
    cmd: uv run src/2_train/multi_train.py data/processed/sampled
    deps:
    - path: data/processed/sampled
      hash: md5
      md5: bd0625130715d04e512025e80e05e0c2.dir
      size: 54219621
      nfiles: 3
    - path: src/2_train/multi_train.py
      hash: md5
      md5: 7676c1a04eb681d963c1cb12601e097d
      size: 14165
    params:
      params.yaml:
        train.batch_size: 256
        train.eps_decay: 10000
        train.eps_end: 0.05
        train.eps_start: 0.9
        train.gamma: 0.99
        train.lr: 0.1
        train.memory_size: 100000
        train.n_episodes: 1000
        train.port_dim: 32
        train.protocol_dim: 8
        train.sample_size: 1000
        train.tau: 0.005
        train.update_target_steps: 200
    outs:
    - path: logs/train.log
      hash: md5
      md5: 8bcb5c3977690985a95b59de6fb6ed0d
      size: 145
    - path: logs/train_result.log
      hash: md5
      md5: cfd41501142836120743ca97acc22078
      size: 452502
    - path: models
      hash: md5
      md5: ab56803bfdb252b8295e8a4e1f674806.dir
      size: 2458365
      nfiles: 1
    - path: train/plots
      hash: md5
      md5: 03519fdad9d21c929c891f31adfc9aaf.dir
      size: 7432614
      nfiles: 300
  evaluate:
    cmd: uv run src/3_evaluate/evaluate.py data/processed/normalized/test
    deps:
    - path: data/processed/normalized/test
      hash: md5
      md5: 9273e83cca038c1b5b3ff5ee8f1b0d29.dir
      size: 23238172
      nfiles: 2
    - path: models
      hash: md5
      md5: ab56803bfdb252b8295e8a4e1f674806.dir
      size: 2458365
      nfiles: 1
    - path: src/3_evaluate/evaluate.py
      hash: md5
      md5: 8ad6303cd66e5adf0cfb4092f64455a2
      size: 5247
    outs:
    - path: evaluate
      hash: md5
      md5: 852f9bd58b17500d71e9a7b670830b15.dir
      size: 24725
      nfiles: 2
    - path: logs/evaluate.log
      hash: md5
      md5: 58dbe163caaef2c3bc951f79420ee7b2
      size: 242
